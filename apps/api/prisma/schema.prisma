generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum VerificationLevel {
  NONE
  PHONE_EMAIL
  ID_KYC
  WORK_INCOME
}

model User {
  id             String   @id @default(cuid())
  email          String   @unique
  phone          String?  @unique
  passwordHash   String
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt
  profile        Profile?
  subscriptions  Subscription[]
}

model Profile {
  id               String   @id @default(cuid())
  userId           String   @unique
  user             User     @relation(fields: [userId], references: [id])
  name             String
  dob              DateTime
  gender           String
  heightCm         Int?
  religion         String?
  community        String?
  languages        String[]
  locationGeo      String?
  education        String?
  profession       String?
  incomeRange      String?
  diet             String?
  habits           String?
  maritalStatus    String?
  about            String?
  privacyFlags     Json?
  verification     VerificationLevel @default(NONE)
  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt
}

model SubscriptionPlan {
  id            String   @id @default(cuid())
  name          String
  priceInr      Int
  benefits      Json
  isRecurring   Boolean  @default(true)
  createdAt     DateTime @default(now())
  subscriptions Subscription[]
}

model Subscription {
  id          String   @id @default(cuid())
  userId      String
  user        User     @relation(fields: [userId], references: [id])
  planId      String
  plan        SubscriptionPlan @relation(fields: [planId], references: [id])
  status      String
  periodStart DateTime
  periodEnd   DateTime
  autoRenew   Boolean @default(true)
  createdAt   DateTime @default(now())
}

model Transaction {
  id        String   @id @default(cuid())
  userId    String
  gateway   String
  orderId   String?
  paymentId String?
  amount    Int
  currency  String @default("INR")
  status    String
  receiptUrl String?
  meta      Json?
  createdAt DateTime @default(now())
}
